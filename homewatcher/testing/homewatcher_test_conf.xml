<?xml version="1.0" ?>
<config>
	<services>
		<linknx host="localhost" port="1030"/>
		<daemon host="localhost" port="1031"/>
	</services>
	<modes objectId="Mode">
		<mode name="Presence" value="1">
			<sensor>OutdoorTemperature</sensor>
			<event type="entered">
				<action type="send-email" to="notify@bar.com"/>
				<action type="copy-value" from="Mode" to="AppliedMode"/>
			</event>
			<event type="left">
				<action type="copy-value" from="AppliedMode" to="PreviousMode"/>
			</event>
		</mode>
		<mode name="Away" value="2">
			<sensor>EntranceDoorOpening</sensor>
			<sensor>GarageDoorOpening</sensor>
			<sensor>LivingRoomWindowOpening</sensor>
			<sensor>KitchenWindowOpening</sensor>
			<sensor>KitchenSmokeSensor</sensor>
			<sensor>BedroomSmokeSensor</sensor>
			<sensor>OutdoorTemperature</sensor>
			<event type="entered">
				<action type="send-email" to="notify@bar.com"/>
				<action type="copy-value" from="Mode" to="AppliedMode"/>
			</event>
			<event type="left">
				<action type="copy-value" from="AppliedMode" to="PreviousMode"/>
			</event>
		</mode>
		<mode name="Night" value="3">
			<sensor>EntranceDoorOpening</sensor>
			<sensor>LivingRoomWindowOpening</sensor>
			<sensor>OutdoorTemperature</sensor>
			<event type="entered">
				<action type="send-email" to="notify@bar.com"/>
				<action type="copy-value" from="Mode" to="AppliedMode"/>
			</event>
			<event type="left">
				<action type="copy-value" from="AppliedMode" to="PreviousMode"/>
			</event>
		</mode>
	</modes>
	<alerts>
		<alert name="Intrusion" persistenceObjectId="IntrusionPersistence" inhibitionObjectId="IntrusionInhibition">
			<event type="started">
				<action type="set-value" id="IntrusionAlertStarted" value="on"/>
			</event>
			<event type="sensor joined">
				<action type="send-email" to="intrusion@foo.com"/>
				<action type="set-value" id="IntrusionSensorJoined" value="on"/>
			</event>
			<event type="sensor left">
				<action type="set-value" id="IntrusionSensorLeft" value="on"/>
			</event>
			<event type="activated">
				<action type="set-value" id="Siren" value="on"/>
				<action type="set-value" id="IntrusionAlertActivated" value="on"/>
			</event>
			<event type="paused">
				<action type="set-value" id="Siren" value="off"/>
				<action type="conditional">
					<condition type="object" id="IntrusionSensorLeft" value="on"/>
					<action type="set-value" id="IntrusionAlertPaused" value="on"/>
				</action>
			</event>
			<event type="resumed">
				<action type="set-value" id="IntrusionAlertResumed" value="on"/>
			</event>
			<event type="stopped">
				<action type="set-value" id="IntrusionAlertStopped" value="on"/>
			</event>
		</alert>
		<alert name="Fire" persistenceObjectId="FirePersistence" >
			<event type="sensor joined">
				<action type="send-email" to="fire@foo.com"/>
			</event>
			<event type="activated">
				<action type="set-value" id="FireSiren" value="on"/>
			</event>
			<event type="paused">
				<action type="set-value" id="FireSiren" value="off"/>
			</event>
		</alert>
		<alert name="Temperature" persistenceObjectId="TemperaturePersistence" >
			<event type="sensor joined">
				<action type="send-email" to="fire@foo.com"/>
			</event>
		</alert>
	</alerts>
	<sensors>
		<sensor isClass="true" name="OpeningSensor" type="boolean" watchedObjectId="OpeningTrigger{location}" enabledObjectId="OpeningEnabled{location}" alert="Intrusion" activationDelay="1" prealertTimeout="2" postalertTimeout="2"/>
		<sensor isClass="true" name="SmokeSensor" type="boolean" watchedObjectId="SmokeTrigger{location}" enabledObjectId="SmokeEnabled{location}" alert="Fire" activationDelay="1" prealertTimeout="0" postalertTimeout="10"/>

		<sensor name="EntranceDoorOpening" type="OpeningSensor" location="Entrance">
			<activationDelay>
				<value mode="Away">5</value>
				<value mode="Night">3</value>
			</activationDelay>
			<prealertTimeout>
				<value mode="Away">6</value>
			</prealertTimeout>
		</sensor>
		<sensor name="GarageDoorOpening" type="OpeningSensor" location="Garage" activationDelay="5">
			<activationCriterion type="and">
				<activationCriterion type="sensor" sensor="EntranceDoorOpening" whenTriggered="false"/>
				<activationCriterion type="sensor" sensor="{name}" whenTriggered="false"/>
			</activationCriterion>
		</sensor>
		<sensor name="KitchenWindowOpening" type="OpeningSensor" location="Kitchen"/>
		<sensor name="LivingRoomWindowOpening" type="OpeningSensor" location="LivingRoom" postalertTimeout="5">
			<activationDelay>
				<value mode="Night">3</value>
			</activationDelay>
		</sensor>

		<sensor name="BedroomSmokeSensor" type="SmokeSensor" location="Bedroom"/>
		<sensor name="KitchenSmokeSensor" type="SmokeSensor" location="Kitchen"/>

		<sensor name="OutdoorTemperature" type="float" alert="Temperature" watchedObjectId="OutdoorTemperature" enabledObjectId="OutdoorTemperatureEnabled" lowerBound="0" upperBound="30.5" hysteresis="2"/> 
	</sensors>
</config>
